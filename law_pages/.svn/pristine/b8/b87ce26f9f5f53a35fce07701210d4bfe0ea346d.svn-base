<style type="text/css">
	.modal-lg{
		width: 100% !important;
		height: 100% !important;
	}
	.modal-dialog{
		margin:0 !important;
		width: 100% !important;
		height: 100% !important;
	}
	.modal{
		
	}
	.modal-content{
		height: 100% !important;
		background: #000000;
		/*position: absolute;*/
		top: 0px;
		left: 0px;
		width: 100%;
		z-index: 99999999991;
		overflow:auto;
	}
	.highMeter_img{
		width:700px; 
		margin-top:80px; 
		position: relative; 
		left:50%;
		margin-left:-350px; 
		text-align:center;
		background-color:rgba(0,0,0,0.5)
	}
	.highMeter_img .iconfont{
		color: #fff;
		position:relative;
		top:5px;
		right: -365px;
		font-size: 28px;
	}
</style>

	<div class="header_e" ng-hide="isSelf== '1'">
		<div class="col-xs-11">
			<div class="col-xs-1 text-align-center">
				<img class="Court_logo" src="views/images/logo.png">
			</div>
		</div>
	</div>
	<div class="img_big_box" >
		<img id="highMeterBigImg" class="img_big_box_img"  src="http://127.0.0.1:38088/video=stream&camidx=0" >

		<!-- <img id="streamimage" class="xform" /> -->
		<div class="img_big_box_b">
		
			<img   src="views/images/xiangji.png"  ng-click="takecareof()">
			 <!-- <img id="snapshot" src="" alt="This is a static snapshot" />	 -->
			
			 <div class="xuanzhuan_btn" ng-click="rotate()" ><iconfont class="iconfont icon-xuanzhuan"></iconfont> 旋转</div> -->
		 	>
		<div class="xuanzhuan_btn" id="rotate" >
		<iconfont class="iconfont icon-xuanzhuan"></iconfont> 旋转
		</div> 
		</p>
			
		</div>
	</div>

	<div class="cont_img_list_box">
		<div class="cont_img_list_box_bt">
			<div class="icon_box"><iconfont class="iconfont icon-xiangji1"></iconfont></div>
			<div class="cont_img_list_box_bt_text">已拍摄(0)</div>
			 <!--<div class="cont_img_list_box_btn" ng-click="uploadbase64img()"><iconfont class="iconfont icon-shuruzhengque"></iconfont> 完成</div> -->
			 <div class="cont_img_list_box_btn" ng-click="uploadbase64imgmult()"><iconfont class="iconfont icon-shuruzhengque"></iconfont> 完成</div> 
			<div class="cont_img_list_box_btn margin-right-20" ng-click="closeTheWindow()"><iconfont class="iconfont icon-guanbi"></iconfont> 关闭</div>


		</div>
		<div class="cont_img_list_box_c">
<!-- 			<dl class="cont_img_list_box_e">
				<dd>
					<img class="snapshot" src="views/images/_r2_c21.png">
					<div class="cont_img_list_box_e_btn">
						<span class="left_btn">删除 </span>
						<span>&nbsp; | &nbsp; </span>
						<span class="right_btn" ng-click="zoomImage('views/images/_r2_c21.png')"> 查看</span>
					<span class="right_btn"> 查看</span> 
					</div>
				</dd>
				<dt>xxxxx</dt>
			</dl>
			<dl class="cont_img_list_box_e">
				<dd>
					<img src="views/images/_r2_c21.png">
					<div class="cont_img_list_box_e_btn">
						<span class="left_btn">删除 </span>
						<span>&nbsp; | &nbsp; </span>
						<span class="right_btn"> 查看</span>
					</div>
				</dd>
				<dt>xxxxx</dt>
			</dl>
			<dl class="cont_img_list_box_e">
				<dd>
					<img src="file:///C:/ProgramData/CameraService/grab_tmp/d8aedcc4-52d9-4ec7-a298-141f9f76de33.jpg">
					<div class="cont_img_list_box_e_btn">
						<span class="left_btn">删除 </span>
						<span>&nbsp; | &nbsp; </span>
						<span class="right_btn"> 查看</span>
					</div>
				</dd>
				<dt>xxxxx</dt>
			</dl>
			<dl class="cont_img_list_box_e">
				<dd>
					<img src="views/images/_r2_c21.png">
					<div class="cont_img_list_box_e_btn">
						<span class="left_btn">删除 </span>
						<span>&nbsp; | &nbsp; </span>
						<span class="right_btn"> 查看</span>
					</div>
				</dd>
				<dt>xxxxx</dt>
			</dl>
			<dl class="cont_img_list_box_e">
				<dd>
					<img src="views/images/_r2_c21.png">
					<div class="cont_img_list_box_e_btn">
						<span class="left_btn">删除 </span>
						<span>&nbsp; | &nbsp; </span>
						<span class="right_btn"> 查看</span>
					</div>
				</dd>
				<dt>xxxxx</dt>
			</dl>
			<dl class="cont_img_list_box_e">
				<dd>
					<img src="views/images/_r2_c21.png">
					<div class="cont_img_list_box_e_btn">
						<span class="left_btn">删除 </span>
						<span>&nbsp; | &nbsp; </span>
						<span class="right_btn"> 查看</span>
					</div>
				</dd>
				<dt>xxxxx</dt>
			</dl>
			<div class="clear"></div> -->
		</div>
	</div>
	<div id="result"></div>
	<div id="fileLink"></div>

<script type="text/javascript">
    
    var phi = 0;
	var camidx = 0; 
	var uuid = "";
	var filepath = "";
	var filelist = "";

	function setXformClass () {
		$('.xform').each(function(idx,el) {
			el.className = "xform x" + "-rotated-" + phi;
		});
	}
    $(document).ready(function() {
		// set rotation angle phi and toggle rotate class
		$('#rotate').click(function() {
			phi = (phi + 90) % 360;
			setXformClass();
			if (phi % 180) {
				$('.xform-p').addClass('rotated');
			} else {
				$('.xform-p').removeClass('rotated');
			}
		});
	});
	
	
		//初始化
/* 	function Init(){
		GetResolution();
	}
 */
	window.onload=function(){
		GetResolution();
	}
	function AppendLink(filePath, type) {
		var div = document.getElementById("fileLink");
		var linkTmp = document.createElement("a");
		linkTmp.href = "file:\/\/\/" + filePath.toString();
		if(type == 0)
			linkTmp.innerText = "图像 "; 
		else
			linkTmp.innerText = "PDF "; 
		linkTmp.target = "_blank"
		div.appendChild(linkTmp);
	}	
	


	
	
	
	function GrabImage() {
	
		document.getElementById("result").innerHTML = "";
		
		var cutpage = document.getElementsByName("cutpage");  
		var params = "{\"filepath\":\"\",\"rotate\":\"" + phi.toString() + "\",\"camidx\":\"" + camidx.toString() + "\",\"cutpage\":\"" + (cutpage[0].checked ? "1" : "0") + "\"}";//
		var url = "http://127.0.0.1:38088/video=grabimage";  	
		//alert(params);    
		$.ajax({  
			type: "post",  
			url: url,  
			dataType: "json", 
			data: params,
			success: function(data)
			{				
				if(data.code != 0)
				{
					document.getElementById("result").innerHTML = "GrabImage 失败<br />返回代码 = " + data.code + "<br />  返回信息 = " + data.message; 	
				}
				else
				{
					document.getElementById("snapshot").src="http://127.0.0.1:38088/video=snapshot&id=" + data.uuid;
					//alert( data.filepath);
					AppendLink(data.filepath, 0);
					uuid = data.uuid;
					//alert( data.filepath);
					filepath = data.filepath;
				}  
			}
		});  
	}	
	
	
	
	
	
	function GetResolution() {
		//alert("sdfsfsfd");
		var params = "{\"type\": \"resolution\",\"camidx\":\"" + camidx.toString() + "\"}";//
		var url = "http://127.0.0.1:38088/param=get";  

		$.ajax({  
			type: "post",  
			url: url,  
			dataType: "json", 
			data: params,
			success: function(data)
			{
				if(data.code != 0)
				{
					document.getElementById("result").innerHTML = "GetResolution 失败<br />返回代码 = " + data.code + "<br />  返回信息 = " + data.message; 	
				}
				else
				{
					var select = document.getElementById("resolution");
					//获取select下拉框下所有的选项
					while(select.options.length > 0)
					{
						select.remove(i);
					}
					
					var arrays = data.resolution.split("|");
					for(var i=0; i<arrays.length; i++)
					{
						select.options.add(new Option(arrays[i], arrays[i])); 
					}
										
					document.getElementById("result").innerHTML = "GetResolution 成功<br />返回代码 = " + data.code; 	
				}  				
			}
		});  
	}	
	
	
	
	
	
	function SelectCamera() {
		var camradio = document.getElementsByName("camidx");
		for(i=0;i<camradio.length;i++)
		{
			if(camradio[i].checked)
				camidx = camradio[i].value;
		}
		
		document.getElementById("streamimage").src="http://127.0.0.1:38088/video=stream&camidx=" + camidx.toString();
		GetResolution();
	
	}	
	
	function ProcessVideoData() {
		var radio = document.getElementsByName("provideo");
		var provideo;
		for(i=0;i<radio.length;i++)
		{
			if(radio[i].checked)
				provideo = radio[i].value;
		}
		
		var params = "{\"provideo\":\"" + provideo.toString() + "\",\"camidx\":\"" + camidx.toString() + "\"}";//
		var url = "http://127.0.0.1:38088/param=set";  

		$.ajax({  
			type: "post",  
			url: url,  
			dataType: "json", 
			data: params,
			success: function(data)
			{				
				document.getElementById("result").innerHTML = "ProcessVideoData <br />返回代码 = " + data.code + "<br />  返回信息 = " + data.message; 	
			}
		});  
	}	
		

	</script>